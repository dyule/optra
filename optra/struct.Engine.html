<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Engine` struct in crate `optra`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Engine">

    <title>optra::Engine - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>optra</a></p><script>window.sidebarCurrent = {name: 'Engine', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>optra</a>::<wbr><a class='struct' href=''>Engine</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-591' class='srclink' href='../src/optra/src/engine.rs.html#25-35' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Engine {
    // some fields omitted
}</pre><div class='docblock'><p>Process file change operations in such a way that they can be synchronized across sites</p>

<p>The engine keeps track of all transactions that have occurred so far, and makes sure that any operations that
happen locally or remotely will result in a consistent file on every site.</p>

<p>To use, simply pass through any local edits via <code>process_diffs()</code> (if they are recorded in a <a href="https://dyule.github.io/rdiff/rdiff/struct.Diff.html"><code>Diff</code></a>)
or <code>process_transaction()</code> (If the operations are already stored in a <a href="struct.TransactionSequence.html"><code>TransactionSequence</code></a>) and pass any remote edits received into <code>integrate_remote()</code>.</p>

<p>See the module level documentation for an example.</p>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl <a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-623' class='srclink' href='../src/optra/src/engine.rs.html#66-245' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.new' class='method'><code>fn <a href='#method.new' class='fnname'>new</a>(site_id: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>) -&gt; <a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a></code></h4>
<div class='docblock'><p>Creates a new engine for the given site id.  The id should be
unique across all clients, and probably generated by the server</p>
</div><h4 id='method.process_diffs' class='method'><code>fn <a href='#method.process_diffs' class='fnname'>process_diffs</a>(&amp;mut self, diff: Diff, stamper: &amp;mut <a class='struct' href='../optra/struct.TimeStamper.html' title='optra::TimeStamper'>TimeStamper</a>) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(</a><a class='struct' href='../optra/struct.TransactionSequence.html' title='optra::TransactionSequence'>TransactionSequence</a>, <a class='struct' href='https://doc.rust-lang.org/nightly/collections/btree/map/struct.BTreeMap.html' title='collections::btree::map::BTreeMap'>BTreeMap</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>,&nbsp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>)</a>&gt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>)</a></code></h4>
<div class='docblock'><p>Convert the diffs we got from analyzing a file into a TransactionSequence
we can send to another site for synchronization.</p>
</div><h4 id='method.integrate_remote' class='method'><code>fn <a href='#method.integrate_remote' class='fnname'>integrate_remote</a>(&amp;mut self, remote_sequence: &amp;mut <a class='struct' href='../optra/struct.TransactionSequence.html' title='optra::TransactionSequence'>TransactionSequence</a>, lookup: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/collections/btree/map/struct.BTreeMap.html' title='collections::btree::map::BTreeMap'>BTreeMap</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>,&nbsp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>)</a>&gt;, stamper: &amp;mut <a class='struct' href='../optra/struct.TimeStamper.html' title='optra::TimeStamper'>TimeStamper</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='struct' href='../optra/struct.OTError.html' title='optra::OTError'>OTError</a>&gt;</code></h4>
<div class='docblock'><p>Integrates the sequence of operations given by <code>remote_sequence</code> into the local history.  The ordering
properties of the local history will be maintained, and a sequence of operations that
can be applied to the local state will be returned.</p>
</div><h4 id='method.process_transaction' class='method'><code>fn <a href='#method.process_transaction' class='fnname'>process_transaction</a>(&amp;mut self, outgoing_sequence: &amp;mut <a class='struct' href='../optra/struct.TransactionSequence.html' title='optra::TransactionSequence'>TransactionSequence</a>)</code></h4>
<div class='docblock'><p>Processes a series of operations prior to being sent out to remote sites.  The operations must
have been performed on the data after every operation in the local history, but no others.  The
operations in the transaction must also be effect order, with the inserts preceding the deletes.</p>
</div><h4 id='method.get_operations_since' class='method'><code>fn <a href='#method.get_operations_since' class='fnname'>get_operations_since</a>(&amp;self, remote_state: <a class='enum' href='https://doc.rust-lang.org/nightly/core/option/enum.Option.html' title='core::option::Option'>Option</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>)</a>&gt;, stamper: &amp;<a class='struct' href='../optra/struct.TimeStamper.html' title='optra::TimeStamper'>TimeStamper</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='struct' href='../optra/struct.TransactionSequence.html' title='optra::TransactionSequence'>TransactionSequence</a>,&nbsp;<a class='struct' href='../optra/struct.OTError.html' title='optra::OTError'>OTError</a>&gt;</code></h4>
<div class='docblock'><p>Get all the operations since, but not including the given state</p>
</div><h4 id='method.compress_to' class='method'><code>fn <a href='#method.compress_to' class='fnname'>compress_to</a>&lt;W:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/std/io/trait.Write.html' title='std::io::Write'>Write</a>&gt;(&amp;self, writer: &amp;mut W) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>&gt;</code></h4>
<div class='docblock'><p>Compress this engine and write to <code>writer</code>.  The output can then be expanded
back into an equivilent Engine using <code>expand_from()</code></p>
</div><h4 id='method.expand_from' class='method'><code>fn <a href='#method.expand_from' class='fnname'>expand_from</a>&lt;R:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/std/io/trait.Read.html' title='std::io::Read'>Read</a>&gt;(reader: &amp;mut R, site_id: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/std/io/error/type.Result.html' title='std::io::error::Result'>Result</a>&lt;<a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a>&gt;</code></h4>
<div class='docblock'><p>Expand this engine from previously compressed data in <code>reader</code>.  The data in reader
should have been written using <code>compress_to()</code></p>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a> for <a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-585' class='srclink' href='../src/optra/src/engine.rs.html#24' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.clone' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html#tymethod.clone' class='fnname'>clone</a>(&amp;self) -&gt; <a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a></code></h4>
<div class='docblock'><p>Returns a copy of the value. <a href="https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html#tymethod.clone">Read more</a></p>
</div><h4 id='method.clone_from' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html#method.clone_from' class='fnname'>clone_from</a>(&amp;mut self, source: &amp;Self)</code><div class='since' title='Stable since Rust version 1.0.0'>1.0.0</div></h4>
<div class='docblock'><p>Performs copy-assignment from <code>source</code>. <a href="https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html#method.clone_from">Read more</a></p>
</div></div><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> for <a class='struct' href='../optra/struct.Engine.html' title='optra::Engine'>Engine</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-889' class='srclink' href='../src/optra/src/engine.rs.html#486-492' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.fmt' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt' class='fnname'>fmt</a>(&amp;self, f: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Error.html' title='core::fmt::Error'>Error</a>&gt;</code></h4>
<div class='docblock'><p>Formats the value using the given formatter.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "optra";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>